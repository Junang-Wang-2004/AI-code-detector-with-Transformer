class C1:

    def __init__(self, a1):
        self.p = list(range(a1))
        self.rnk = [0] * a1

    def get(self, a1):
        if self.p[a1] != a1:
            self.p[a1] = self.get(self.p[a1])
        return self.p[a1]

    def merge(self, a1, a2):
        v1 = self.get(a1)
        v2 = self.get(a2)
        if v1 == v2:
            return
        if self.rnk[v1] > self.rnk[v2]:
            self.p[v2] = v1
        elif self.rnk[v1] < self.rnk[v2]:
            self.p[v1] = v2
        else:
            self.p[v2] = v1
            self.rnk[v1] += 1

class C2:

    def minMalwareSpread(self, a1, a2):
        v1 = len(a1)
        v2 = C1(v1)
        for v3 in range(v1):
            for v4 in range(v3 + 1, v1):
                if a1[v3][v4]:
                    v2.merge(v3, v4)
        v5 = {}
        for v3 in range(v1):
            v6 = v2.get(v3)
            v5[v6] = v5.get(v6, 0) + 1
        v7 = {}
        for v8 in a2:
            v6 = v2.get(v8)
            v7[v6] = v7.get(v6, 0) + 1
        v9 = -1
        v10 = float('inf')
        for v8 in a2:
            v6 = v2.get(v8)
            v11 = v7[v6]
            v12 = v5[v6] if v11 == 1 else 0
            if v12 > v9 or (v12 == v9 and v8 < v10):
                v9 = v12
                v10 = v8
        return v10
