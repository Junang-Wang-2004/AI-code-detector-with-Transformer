import collections

class C1(object):

    def __init__(self, a1):
        self.set = list(range(a1))

    def find_set(self, a1):
        if self.set[a1] != a1:
            self.set[a1] = self.find_set(self.set[a1])
        return self.set[a1]

    def union_set(self, a1, a2):
        v1, v2 = list(map(self.find_set, (a1, a2)))
        if v1 == v2:
            return False
        self.set[min(v1, v2)] = max(v1, v2)
        return True

class C2(object):

    def minMalwareSpread(self, a1, a2):
        """
        """
        v1 = set(a2)
        v2 = [i for v3 in range(len(a1)) if v3 not in v1]
        v4 = C1(len(a1))
        for v3 in range(len(v2)):
            for v5 in range(v3 + 1, len(v2)):
                if a1[v2[v3]][v2[v5]] == 1:
                    v4.union_set(v2[v3], v2[v5])
        v6 = collections.Counter((v4.find_set(v3) for v3 in range(len(a1))))
        v7 = collections.defaultdict(set)
        for v3 in a2:
            for v5 in v2:
                if a1[v3][v5] == 1:
                    v8 = v4.find_set(v5)
                    v7[v8].add(v3)
        v9, v10 = (float('inf'), float('-inf'))
        for v3 in a2:
            v11 = set()
            v12 = 0
            for v5 in v2:
                if a1[v3][v5] == 1:
                    v8 = v4.find_set(v5)
                    if len(v7[v8]) == 1 and v8 not in v11:
                        v12 += v6[v8]
                        v11.add(v8)
            if v12 > v10 or (v12 == v10 and v3 < v9):
                v10 = v12
                v9 = v3
        return v9
